let db,Helper,adminQueries,super_queries;_ada‍.x([["default",()=>SuperService]]);_ada‍.w("../config/config",[["default",["db"],function(v){db=v}]]);_ada‍.w("../utils/helpers/helpers",[["default",["Helper"],function(v){Helper=v}]]);_ada‍.w("../queries/admin.queries",[["default",["adminQueries"],function(v){adminQueries=v}]]);_ada‍.w("../queries/super.queries",[["default",["super_queries"],function(v){super_queries=v}]]);




const { fetchResourceByPage, calcPages } = Helper;
const {
  findSuperByEmail,
  fetchAllUsers,
  fetchUsersCount,
  createAdmin,
  findUserByID,
  setClientStatus,
  setAdminStatus,
} = super_queries;
const { findAdminByEmail, findAdminByID } = adminQueries;

               class SuperService {
  /**
   * get super admin by email
   * @memberof SuperService
   */
  static async findSuperByEmail(email) {
    return db.oneOrNone(findSuperByEmail, [email]);
  }

  /**
   * get admin by email
   * @memberof SuperService
   */
  static async findAdminByEmail(email) {
    return db.oneOrNone(findAdminByEmail, [email]);
  }

  /**
   * fetch all users
   * @memberof SuperService
   */
  static async fetchAllUsers({ page = 1, limit = 10 }) {
    const [total, result] = await fetchResourceByPage({
      page,
      limit,
      getCount: fetchUsersCount, //query to count all movies
      getResources: fetchAllUsers, //query to get all the movies
    });
    return {
      total: +total.count,
      currentPage: +page,
      totalPages: calcPages(total.count, limit),
      result,
    };
  }

  /**
   * create admin
   * @memberof SuperService
   */
  static async createAdmin(data) {
    const { name, email } = data;
    return db.none(createAdmin, [name, email]);
  }
  /**
   * fetch admin by id
   * @memberof SuperService
   */
  static async fetchAdmin(id) {
    return db.oneOrNone(findAdminByID, [id]);
  }

  /**
   * fetch user by id
   * @memberof SuperService
   */
  static async fetchUser(id) {
    return db.oneOrNone(findUserByID, [id]);
  }

  /**
   * change user account status
   * @memberof SuperService
   */
  static async setUserStatus(data) {
    const { id, status } = data;
    return db.none(setClientStatus, [status, id]);
  }

  /**
   * change admin account status
   * @memberof SuperService
   */
  static async setAdminStatus(data) {
    const { id, status } = data;
    return db.none(setAdminStatus, [status, id]);
  }
}
