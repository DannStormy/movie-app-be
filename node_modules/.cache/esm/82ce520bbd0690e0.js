let MovieService;_bd0‍.x([["fetchMovies",()=>fetchMovies],["fetchMovieByID",()=>fetchMovieByID],["updateMovieRating",()=>updateMovieRating],["addNewMovie",()=>addNewMovie],["deleteMovie",()=>deleteMovie]]);_bd0‍.w("../services/movie.service",[["default",["MovieService"],function(v){MovieService=v}]]);

const { getMovies, getMovieByID, rateMovie, addMovie, removeMovie } =
  MovieService;

const fetchMovies = async (req, res) => {
  try {
    // const {title, genre, year} = req.query
    // if (title || genre || year) {
    //   console.log('Here', req.query)
    //   const movies = await movie(req.query);
    //   return res.status(200).json({
    //     message: `movies returned`,
    //     data: movies,
    //   });
    // }
    // const movies = await fetchAllMovies(req.query);
    // return res.status(200).json({
    //   message: "movies fetched",
    //   data: movies,
    // });
    _bd0‍.g.console.log("All queries", req.query);
    const movies = await getMovies(req.query);
    return res.status(200).json({
      message: `movies returned`,
      data: movies,
    });
  } catch (error) {
    _bd0‍.g.console.log(error); //will use logger instead (testing now)
    return error;
  }
};

const fetchMovieByID = async (req, res) => {
  try {
    const movie = await getMovieByID(req.params);
    return res.status(200).json({
      message: `movie with id:${req.params.id} fetched`,
      data: movie,
    });
  } catch (error) {
    _bd0‍.g.console.log(error); //will use logger instead (testing now)
    return error;
  }
};

const updateMovieRating = async (req, res) => {
  console.log('Here')
  try {
    await rateMovie(req.body);
    return res.status(200).json({
      message: `movie rated`,
    });
  } catch (error) {
    _bd0‍.g.console.log(error); //will use logger instead (testing now)
    return error;
  }
};

const addNewMovie = async (req, res) => {
  try {
    await addMovie(req.body);
    return res.status(200).json({
      message: "movie added",
      data: req.body,
    });
  } catch (error) {
    _bd0‍.g.console.log(error);
    return error;
  }
};

const deleteMovie = async (req, res) => {
  try {
    const movie = await getMovieByID(req.params);
    if (!movie)
      return res
        .status(400)
        .json({ message: `Movie with id:${req.params.id} not found` });
    await removeMovie(req.params);
    return res.status(200).json({
      message: `movie with id: ${req.params.id} removed`,
    });
  } catch (error) {
    _bd0‍.g.console.log(error);
    return error;
  }
};








